<!DOCTYPE html>
<html>
<head>
    <title>BudgetBuddy</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h1>BudgetBuddy</h1>
    <form id="budget-form">
        <label for="income">Monthly income:</label>
        <input type="number" id="income" name="income" required><br><br>
        
        <label for="allocation">Do you prefer to save or invest?</label>
        <select id="allocation" name="allocation">
            <option value="save">Save</option>
            <option value="invest">Invest</option>
        </select><br><br>
        
        <label for="hasDebt">Do you have debt?</label>
        <select id="hasDebt" name="hasDebt">
            <option value="no">No</option>
            <option value="yes">Yes</option>
        </select><br><br>

        <label for="paysRent">Do you pay rent?</label>
        <select id="paysRent" name="paysRent">
            <option value="no">No</option>
            <option value="yes">Yes</option>
        </select><br><br>

        <div id="rent-form" style="display: none;">
            <label for="monthlyRent">Monthly Rent Payment:</label>
            <input type="number" id="monthlyRent" name="monthlyRent"><br><br>
        </div>

        <div id="debt-form" style="display: none;">
            <label for="principal">Principal Amount:</label>
            <input type="number" id="principal" name="principal"><br><br>
            
            <label for="loanTerm">Loan Term (months):</label>
            <input type="number" id="loanTerm" name="loanTerm"><br><br>
            
            <label for="monthlyInterestRate">Monthly Interest Rate (%):</label>
            <input type="number" id="monthlyInterestRate" name="monthlyInterestRate"><br><br>
        </div>
        
        <input type="submit" value="Generate Pie Chart">
        <input type="button" value="Reset" id="reset-button">
    </form>

    <canvas id="pie-chart" width="400" height="400" style="display: none;"></canvas>

    <script>
        let myPieChart;

        document.getElementById("budget-form").addEventListener("submit", function(event) {
            event.preventDefault();

            const income = parseFloat(document.getElementById("income").value);
            const allocation = document.getElementById("allocation").value;
            const hasDebt = document.getElementById("hasDebt").value;
            const paysRent = document.getElementById("paysRent").value;

            let savings, investment, expenses, debtPayment, rentPayment;

            if (allocation === "save") {
                savings = 0.325 * income;
                investment = 0.125 * income;
            } else if (allocation === "invest") {
                savings = 0.20 * income;
                investment = 0.25 * income;
            }

            expenses = income - savings - investment;

            //Debt payment calculation
            if (hasDebt === "yes") {
                const principal = parseFloat(document.getElementById("principal").value);
                const loanTerm = parseInt(document.getElementById("loanTerm").value);
                const monthlyInterestRate = (parseFloat(document.getElementById("monthlyInterestRate").value) / 100) / 12;

                const denominator = 1 - Math.pow(1 + monthlyInterestRate, -loanTerm);
                debtPayment = (monthlyInterestRate * principal) / denominator;
            } else {
                debtPayment = 0;
            }

            //Rent payment calculation
            if (paysRent === "yes") {
                rentPayment = parseFloat(document.getElementById("monthlyRent").value);
            } else {
                rentPayment = 0;
            }

            const data = {
                labels: ["Savings", "Investment", "Expenses", "Debt Payment", "Rent Payment"],
                datasets: [{
                    data: [savings, investment, expenses, debtPayment, rentPayment],
                    backgroundColor: ["#36A2EB", "#FFCE56", "#FF6384", "#4CAF50", "#FF5733"]
                }]
            };

            const canvas = document.getElementById("pie-chart");
            canvas.style.display = "block";

            const ctx = canvas.getContext("2d");

            // Clear the previous chart instance if it exists
            if (myPieChart) {
                myPieChart.destroy();
            }

            //Create the new pie chart instance
            myPieChart = new Chart(ctx, {
                type: "pie",
                data: data,
            });
        });

        document.getElementById("hasDebt").addEventListener("change", function() {
            const debtForm = document.getElementById("debt-form");
            const hasDebt = this.value;

            if (hasDebt === "yes") {
                debtForm.style.display = "block"; //Show the debt-related questions
            } else {
                debtForm.style.display = "none";  //Hide the debt-related questions
            }
        });

        document.getElementById("paysRent").addEventListener("change", function() {
            const rentForm = document.getElementById("rent-form");
            const paysRent = this.value;

            if (paysRent === "yes") {
                rentForm.style.display = "block"; //Show the rent payment question
            } else {
                rentForm.style.display = "none";  //Hide the rent payment question
            }
        });

        document.getElementById("reset-button").addEventListener("click", function() {
            document.getElementById("budget-form").reset();
            document.getElementById("debt-form").style.display = "none";
            document.getElementById("rent-form").style.display = "none";
            document.getElementById("pie-chart").style.display = "none";

            //Clear the previous chart instance if it exists
            if (myPieChart) {
                myPieChart.destroy();
            }
        });
    </script>
</body>
</html>
